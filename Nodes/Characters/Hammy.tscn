[gd_scene load_steps=30 format=3 uid="uid://c12t7hjgom6ao"]

[ext_resource type="Script" uid="uid://d0u8jkch7cah3" path="res://Scripts/hammy.gd" id="1_fic1p"]
[ext_resource type="Texture2D" uid="uid://dateq8dool3x5" path="res://Graphics/Characters/Tammy.png" id="2_wmlf5"]
[ext_resource type="Texture2D" uid="uid://djn1in2ril7u4" path="res://Graphics/Characters/Hammy_Ball.png" id="3_kcjdg"]
[ext_resource type="PackedScene" uid="uid://bnf1ltkjwajsn" path="res://Nodes/Effects/Trail.tscn" id="3_wmlf5"]
[ext_resource type="Script" uid="uid://dmihh8qtreg36" path="res://Scripts/crushDetector.gd" id="5_btdtw"]
[ext_resource type="Script" uid="uid://cvl6hrjija3bq" path="res://Scripts/Spawner.gd" id="6_msu10"]
[ext_resource type="PackedScene" uid="uid://clk12qmlankvr" path="res://Nodes/Effects/TeleportEffect.tscn" id="7_l8fkp"]

[sub_resource type="CircleShape2D" id="CircleShape2D_wmlf5"]
radius = 88.0909

[sub_resource type="Animation" id="Animation_fcgtr"]
resource_name = "Idle"
length = 6.00001
loop_mode = 1
step = 0.0833333
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Sprite:frame")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 1.5, 1.58333, 1.66667, 1.75, 2.25, 2.33333, 2.41667, 2.5, 4.16667, 4.25, 4.33333, 4.41667, 4.5, 4.58333, 4.66667, 4.75),
"transitions": PackedFloat32Array(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1),
"update": 1,
"values": [15, 11, 12, 13, 14, 13, 12, 11, 15, 11, 12, 11, 15, 11, 12, 11, 15]
}

[sub_resource type="Animation" id="Animation_g27f7"]
length = 0.001
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Sprite:frame")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [10]
}

[sub_resource type="Animation" id="Animation_2ld4p"]
resource_name = "Run"
length = 0.375004
loop_mode = 1
step = 0.0416667
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Sprite:frame")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.0416667, 0.0833333, 0.125, 0.166667, 0.208333, 0.25, 0.291667, 0.333333),
"transitions": PackedFloat32Array(1, 1, 1, 1, 1, 1, 1, 1, 1),
"update": 1,
"values": [8, 0, 1, 2, 3, 4, 5, 6, 7]
}

[sub_resource type="Animation" id="Animation_0xo0j"]
resource_name = "TurnIdle"
length = 0.0833375
step = 0.0416667
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Sprite:frame")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.0416667),
"transitions": PackedFloat32Array(1, 1),
"update": 1,
"values": [9, 10]
}

[sub_resource type="Animation" id="Animation_542mk"]
resource_name = "TurnRun"
length = 0.0833375
step = 0.0416667
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Sprite:frame")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.0416667),
"transitions": PackedFloat32Array(1, 1),
"update": 1,
"values": [10, 9]
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_0xo0j"]
_data = {
&"Idle": SubResource("Animation_fcgtr"),
&"RESET": SubResource("Animation_g27f7"),
&"Run": SubResource("Animation_2ld4p"),
&"TurnIdle": SubResource("Animation_0xo0j"),
&"TurnRun": SubResource("Animation_542mk")
}

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_542mk"]
animation = &"Idle"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_0xo0j"]
animation = &"Run"

[sub_resource type="AnimationNodeTimeScale" id="AnimationNodeTimeScale_542mk"]

[sub_resource type="AnimationNodeBlendTree" id="AnimationNodeBlendTree_cqeve"]
graph_offset = Vector2(-574.667, 62.6667)
nodes/Run/node = SubResource("AnimationNodeAnimation_0xo0j")
nodes/Run/position = Vector2(-253.333, 275.333)
nodes/TimeScale/node = SubResource("AnimationNodeTimeScale_542mk")
nodes/TimeScale/position = Vector2(-61.3333, 211.333)
node_connections = [&"TimeScale", 0, &"Run", &"output", 0, &"TimeScale"]

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_2ld4p"]
animation = &"TurnIdle"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_vvetp"]
animation = &"TurnRun"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_r8ynv"]
advance_mode = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_80bak"]

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_ad4cc"]
switch_mode = 2
advance_mode = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_vvetp"]
switch_mode = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_fcgtr"]
switch_mode = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_g27f7"]

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_0xo0j"]

[sub_resource type="AnimationNodeStateMachine" id="AnimationNodeStateMachine_kcjdg"]
states/Idle/node = SubResource("AnimationNodeAnimation_542mk")
states/Idle/position = Vector2(409.333, 78)
states/Run/node = SubResource("AnimationNodeBlendTree_cqeve")
states/Run/position = Vector2(409.778, 274)
states/TurnIdle/node = SubResource("AnimationNodeAnimation_2ld4p")
states/TurnIdle/position = Vector2(602.667, 170.889)
states/TurnRun/node = SubResource("AnimationNodeAnimation_vvetp")
states/TurnRun/position = Vector2(252.444, 164.519)
transitions = ["Start", "Idle", SubResource("AnimationNodeStateMachineTransition_r8ynv"), "Idle", "TurnRun", SubResource("AnimationNodeStateMachineTransition_80bak"), "Idle", "End", SubResource("AnimationNodeStateMachineTransition_ad4cc"), "TurnRun", "Run", SubResource("AnimationNodeStateMachineTransition_vvetp"), "TurnIdle", "Idle", SubResource("AnimationNodeStateMachineTransition_fcgtr"), "Run", "TurnIdle", SubResource("AnimationNodeStateMachineTransition_g27f7"), "TurnIdle", "Run", SubResource("AnimationNodeStateMachineTransition_0xo0j")]

[sub_resource type="CircleShape2D" id="CircleShape2D_kcjdg"]
radius = 48.0

[node name="Hammy" type="CharacterBody2D"]
floor_stop_on_slope = false
floor_block_on_wall = false
floor_max_angle = 0.523599
floor_snap_length = 16.0
platform_wall_layers = 1
script = ExtResource("1_fic1p")

[node name="Sprite" type="Sprite2D" parent="."]
modulate = Color(0.606108, 0.856674, 0.99534, 1)
position = Vector2(0, 29)
scale = Vector2(0.39, 0.39)
texture = ExtResource("2_wmlf5")
hframes = 5
vframes = 4
frame = 10

[node name="HammyBall" type="Sprite2D" parent="."]
position = Vector2(9.53674e-07, 1)
scale = Vector2(1.02041, 1.02041)
texture = ExtResource("3_kcjdg")

[node name="CollisionShape2D" type="CollisionShape2D" parent="."]
shape = SubResource("CircleShape2D_wmlf5")

[node name="BufferTimer" type="Timer" parent="."]
wait_time = 0.05
one_shot = true

[node name="CoyoteTimer" type="Timer" parent="."]
wait_time = 0.1
one_shot = true

[node name="Trail" parent="." instance=ExtResource("3_wmlf5")]

[node name="AnimationPlayer" type="AnimationPlayer" parent="."]
libraries = {
&"": SubResource("AnimationLibrary_0xo0j")
}

[node name="AnimationTree" type="AnimationTree" parent="."]
tree_root = SubResource("AnimationNodeStateMachine_kcjdg")
anim_player = NodePath("../AnimationPlayer")
parameters/Run/TimeScale/scale = 1.0

[node name="Hitbox" type="Area2D" parent="." groups=["Teleportable"]]

[node name="CollisionShape2D" type="CollisionShape2D" parent="Hitbox"]
position = Vector2(0, 41)
shape = SubResource("CircleShape2D_kcjdg")

[node name="CrushDetector" type="RayCast2D" parent="."]
target_position = Vector2(0, 64)
script = ExtResource("5_btdtw")

[node name="Spawner" type="Node2D" parent="."]
script = ExtResource("6_msu10")
spawned_object = ExtResource("7_l8fkp")

[connection signal="crushed" from="CrushDetector" to="." method="_on_crush_detector_crushed"]
